"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9780],{1922:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"admin/usage-billing","title":"Usage & Billing","description":"Comprehensive analytics, usage tracking, and billing management through the Admin API","source":"@site/docs/admin/usage-billing.md","sourceDirName":"admin","slug":"/admin/usage-billing","permalink":"/Conduit/docs/admin/usage-billing","draft":false,"unlisted":false,"editUrl":"https://github.com/knnlabs/Conduit/tree/main/website/docs/admin/usage-billing.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Usage & Billing","description":"Comprehensive analytics, usage tracking, and billing management through the Admin API"},"sidebar":"docsSidebar","previous":{"title":"Provider Configuration","permalink":"/Conduit/docs/admin/provider-configuration"}}');var a=t(4848),r=t(8453);const i={sidebar_position:4,title:"Usage & Billing",description:"Comprehensive analytics, usage tracking, and billing management through the Admin API"},o="Usage & Billing",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:3},{value:"Data Hierarchy",id:"data-hierarchy",level:3},{value:"Real-Time Usage Monitoring",id:"real-time-usage-monitoring",level:2},{value:"Live Usage Dashboard",id:"live-usage-dashboard",level:3},{value:"Usage Trends",id:"usage-trends",level:3},{value:"Virtual Key Usage Analytics",id:"virtual-key-usage-analytics",level:2},{value:"Individual Virtual Key Analytics",id:"individual-virtual-key-analytics",level:3},{value:"Virtual Key Comparison",id:"virtual-key-comparison",level:3},{value:"Provider Analytics",id:"provider-analytics",level:2},{value:"Provider Performance Analysis",id:"provider-performance-analysis",level:3},{value:"Cost Optimization Analysis",id:"cost-optimization-analysis",level:3},{value:"Budget Management",id:"budget-management",level:2},{value:"Budget Configuration and Monitoring",id:"budget-configuration-and-monitoring",level:3},{value:"Budget Alerts and Enforcement",id:"budget-alerts-and-enforcement",level:3},{value:"Budget Forecasting",id:"budget-forecasting",level:3},{value:"Advanced Analytics",id:"advanced-analytics",level:2},{value:"Usage Patterns Analysis",id:"usage-patterns-analysis",level:3},{value:"Performance Analytics",id:"performance-analytics",level:3},{value:"Data Export and Integration",id:"data-export-and-integration",level:2},{value:"Export Usage Data",id:"export-usage-data",level:3},{value:"Integration with External Systems",id:"integration-with-external-systems",level:3},{value:"Custom Reports",id:"custom-reports",level:2},{value:"Creating Custom Reports",id:"creating-custom-reports",level:3},{value:"Scheduled Reports",id:"scheduled-reports",level:3},{value:"Security and Compliance",id:"security-and-compliance",level:2},{value:"Data Privacy",id:"data-privacy",level:3},{value:"Audit Trails",id:"audit-trails",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Analytics Issues",id:"common-analytics-issues",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Usage Monitoring",id:"usage-monitoring",level:3},{value:"Performance Optimization",id:"performance-optimization",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"usage--billing",children:"Usage & Billing"})}),"\n",(0,a.jsx)(n.p,{children:"Conduit provides comprehensive usage tracking, cost analytics, and billing management through the Admin API. This guide covers real-time usage monitoring, cost attribution, billing analytics, and budget management."}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(n.h3,{id:"key-features",children:"Key Features"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Real-Time Usage Tracking"}),": Live monitoring of requests, tokens, and costs"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Granular Attribution"}),": Cost tracking by virtual key, provider, model, and user"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Budget Management"}),": Automated budget enforcement and alerting"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Analytics & Reporting"}),": Comprehensive usage and cost analytics"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Export & Integration"}),": Data export for external billing systems"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"data-hierarchy",children:"Data Hierarchy"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Organization\n\u251c\u2500\u2500 Virtual Keys\n\u2502   \u251c\u2500\u2500 Usage Sessions\n\u2502   \u251c\u2500\u2500 Request Logs\n\u2502   \u2514\u2500\u2500 Cost Breakdowns\n\u251c\u2500\u2500 Providers\n\u2502   \u251c\u2500\u2500 Model Usage\n\u2502   \u251c\u2500\u2500 Rate Limits\n\u2502   \u2514\u2500\u2500 Cost Analysis\n\u2514\u2500\u2500 System Metrics\n    \u251c\u2500\u2500 Performance Data\n    \u251c\u2500\u2500 Error Rates\n    \u2514\u2500\u2500 Health Status\n"})}),"\n",(0,a.jsx)(n.h2,{id:"real-time-usage-monitoring",children:"Real-Time Usage Monitoring"}),"\n",(0,a.jsx)(n.h3,{id:"live-usage-dashboard",children:"Live Usage Dashboard"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Get Current Usage Statistics:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/analytics/usage/live"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "timestamp": "2024-01-15T10:30:00Z",\n    "realTimeMetrics": {\n      "activeRequests": 45,\n      "requestsThisMinute": 1234,\n      "requestsThisHour": 67890,\n      "requestsToday": 1234567,\n      "tokensThisMinute": 156780,\n      "tokensThisHour": 8945678,\n      "costThisMinute": 12.34,\n      "costThisHour": 678.90,\n      "costToday": 12345.67\n    },\n    "topVirtualKeys": [\n      {\n        "keyId": "550e8400-e29b-41d4-a716-446655440000",\n        "keyName": "Production API Key",\n        "requestsThisHour": 12345,\n        "costThisHour": 234.56,\n        "percentageOfTotal": 0.18\n      }\n    ],\n    "topModels": [\n      {\n        "model": "gpt-4",\n        "provider": "openai",\n        "requestsThisHour": 8920,\n        "costThisHour": 456.78,\n        "percentageOfTotal": 0.67\n      }\n    ],\n    "providerDistribution": {\n      "openai": {\n        "requests": 45670,\n        "cost": 789.12,\n        "percentage": 0.67\n      },\n      "anthropic": {\n        "requests": 15680,\n        "cost": 234.56,\n        "percentage": 0.23\n      }\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"usage-trends",children:"Usage Trends"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Get Usage Trends:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/analytics/usage/trends?period=7d&granularity=hour"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "period": "7d",\n    "granularity": "hour",\n    "totalDataPoints": 168,\n    "metrics": {\n      "totalRequests": 1250000,\n      "totalTokens": 125000000,\n      "totalCost": 15234.56,\n      "averageRequestsPerHour": 7440,\n      "peakRequestsPerHour": 12345,\n      "averageCostPerRequest": 0.0122\n    },\n    "timeline": [\n      {\n        "timestamp": "2024-01-15T10:00:00Z",\n        "requests": 8920,\n        "tokens": 1456780,\n        "cost": 187.23,\n        "activeVirtualKeys": 145,\n        "errorRate": 0.012\n      }\n    ],\n    "trends": {\n      "requestGrowth": 0.15,      // 15% growth\n      "costGrowth": 0.12,         // 12% growth\n      "efficiencyImprovement": 0.03 // 3% better cost per token\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"virtual-key-usage-analytics",children:"Virtual Key Usage Analytics"}),"\n",(0,a.jsx)(n.h3,{id:"individual-virtual-key-analytics",children:"Individual Virtual Key Analytics"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Get Virtual Key Usage Details:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/analytics?period=30d&breakdown=daily"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "keyId": "550e8400-e29b-41d4-a716-446655440000",\n    "keyName": "Production API Key",\n    "period": "30d",\n    "summary": {\n      "totalRequests": 125680,\n      "successfulRequests": 124156,\n      "failedRequests": 1524,\n      "totalTokens": 15678900,\n      "inputTokens": 7834567,\n      "outputTokens": 7844333,\n      "totalCost": 2134.56,\n      "averageLatency": 1.23,\n      "errorRate": 0.0121,\n      "costPerRequest": 0.0170,\n      "costPerToken": 0.000136\n    },\n    "budgetStatus": {\n      "maxBudget": 5000.00,\n      "usedBudget": 2134.56,\n      "remainingBudget": 2865.44,\n      "utilizationPercentage": 0.427,\n      "projectedMonthlySpend": 2845.67,\n      "onTrackForBudget": true\n    },\n    "usageBreakdown": {\n      "byModel": {\n        "gpt-4": {\n          "requests": 67890,\n          "tokens": 8945678,\n          "cost": 1678.90,\n          "percentage": 0.787\n        },\n        "gpt-3.5-turbo": {\n          "requests": 45670,\n          "tokens": 5678900,\n          "cost": 345.67,\n          "percentage": 0.162\n        },\n        "claude-3-sonnet": {\n          "requests": 12120,\n          "tokens": 1054322,\n          "cost": 109.99,\n          "percentage": 0.051\n        }\n      },\n      "byOperation": {\n        "chat.completions": {\n          "requests": 118560,\n          "cost": 2001.23,\n          "percentage": 0.937\n        },\n        "embeddings": {\n          "requests": 5680,\n          "cost": 89.45,\n          "percentage": 0.042\n        },\n        "audio.transcriptions": {\n          "requests": 1440,\n          "cost": 43.88,\n          "percentage": 0.021\n        }\n      },\n      "byTimeOfDay": {\n        "00-06": {"requests": 5670, "cost": 89.12},\n        "06-12": {"requests": 45680, "cost": 678.90},\n        "12-18": {"requests": 56780, "cost": 987.65},\n        "18-24": {"requests": 17550, "cost": 378.89}\n      }\n    },\n    "dailyTrend": [\n      {\n        "date": "2024-01-15",\n        "requests": 4567,\n        "tokens": 567890,\n        "cost": 89.12,\n        "peakHour": 14,\n        "errors": 23\n      }\n    ]\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"virtual-key-comparison",children:"Virtual Key Comparison"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Compare Multiple Virtual Keys:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/compare" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "keyIds": [\n      "550e8400-e29b-41d4-a716-446655440000",\n      "550e8400-e29b-41d4-a716-446655440001",\n      "550e8400-e29b-41d4-a716-446655440002"\n    ],\n    "period": "7d",\n    "metrics": ["requests", "cost", "latency", "errorRate"]\n  }\'\n'})}),"\n",(0,a.jsx)(n.h2,{id:"provider-analytics",children:"Provider Analytics"}),"\n",(0,a.jsx)(n.h3,{id:"provider-performance-analysis",children:"Provider Performance Analysis"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Get Provider Analytics:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/providers/analytics?period=30d&breakdown=model"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "period": "30d",\n    "totalCost": 15234.56,\n    "totalRequests": 1250000,\n    "providers": {\n      "openai": {\n        "summary": {\n          "requests": 875000,\n          "cost": 10678.23,\n          "percentage": 0.701,\n          "averageLatency": 1.23,\n          "errorRate": 0.012,\n          "uptime": 0.9995\n        },\n        "models": {\n          "gpt-4": {\n            "requests": 450000,\n            "cost": 8234.45,\n            "inputTokens": 56780000,\n            "outputTokens": 45670000,\n            "averageLatency": 1.45,\n            "costPerRequest": 0.0183,\n            "costPerToken": 0.0000805\n          },\n          "gpt-3.5-turbo": {\n            "requests": 425000,\n            "cost": 2443.78,\n            "inputTokens": 78900000,\n            "outputTokens": 67890000,\n            "averageLatency": 0.89,\n            "costPerRequest": 0.0057,\n            "costPerToken": 0.0000166\n          }\n        },\n        "operations": {\n          "chat.completions": {\n            "requests": 825000,\n            "cost": 9987.65\n          },\n          "embeddings": {\n            "requests": 35000,\n            "cost": 456.78\n          },\n          "audio.transcriptions": {\n            "requests": 15000,\n            "cost": 233.80\n          }\n        }\n      },\n      "anthropic": {\n        "summary": {\n          "requests": 300000,\n          "cost": 3678.90,\n          "percentage": 0.241,\n          "averageLatency": 1.45,\n          "errorRate": 0.008,\n          "uptime": 0.9998\n        },\n        "models": {\n          "claude-3-sonnet": {\n            "requests": 200000,\n            "cost": 2456.78,\n            "inputTokens": 34560000,\n            "outputTokens": 28900000,\n            "averageLatency": 1.34,\n            "costPerRequest": 0.0123\n          },\n          "claude-3-haiku": {\n            "requests": 100000,\n            "cost": 1222.12,\n            "inputTokens": 45670000,\n            "outputTokens": 38900000,\n            "averageLatency": 1.56,\n            "costPerRequest": 0.0122\n          }\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"cost-optimization-analysis",children:"Cost Optimization Analysis"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Get Cost Optimization Insights:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/analytics/cost-optimization?period=30d"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "totalCost": 15234.56,\n    "potentialSavings": 2145.67,\n    "savingsPercentage": 0.141,\n    "recommendations": [\n      {\n        "type": "model_substitution",\n        "description": "Replace gpt-4 with gpt-3.5-turbo for simple tasks",\n        "estimatedSavings": 1234.56,\n        "affectedRequests": 125000,\n        "confidence": 0.85,\n        "implementation": {\n          "virtualKeys": ["550e8400-e29b-41d4-a716-446655440000"],\n          "modelMapping": {\n            "from": "gpt-4",\n            "to": "gpt-3.5-turbo",\n            "conditions": ["input_tokens < 1000", "no_function_calls"]\n          }\n        }\n      },\n      {\n        "type": "provider_routing",\n        "description": "Route Claude requests to Anthropic direct instead of AWS Bedrock",\n        "estimatedSavings": 567.89,\n        "affectedRequests": 45000,\n        "confidence": 0.92\n      },\n      {\n        "type": "caching",\n        "description": "Enable response caching for repeated queries",\n        "estimatedSavings": 343.22,\n        "cacheHitRateProjected": 0.15,\n        "confidence": 0.78\n      }\n    ],\n    "costTrends": {\n      "increasing": [\n        {\n          "category": "gpt-4_usage",\n          "growthRate": 0.25,\n          "projectedMonthlyCost": 12000.00\n        }\n      ],\n      "decreasing": [\n        {\n          "category": "embeddings",\n          "reductionRate": 0.10,\n          "savings": 123.45\n        }\n      ]\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"budget-management",children:"Budget Management"}),"\n",(0,a.jsx)(n.h3,{id:"budget-configuration-and-monitoring",children:"Budget Configuration and Monitoring"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Get Budget Status:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/budgets/status"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "globalBudget": {\n      "maxBudget": 50000.00,\n      "currentSpend": 32145.67,\n      "remainingBudget": 17854.33,\n      "utilizationPercentage": 0.643,\n      "projectedMonthlySpend": 42567.89,\n      "onTrack": true,\n      "daysRemaining": 16,\n      "averageDailySpend": 1072.91\n    },\n    "budgetAlerts": [\n      {\n        "level": "warning",\n        "message": "Virtual key \'Production API Key\' has reached 80% of budget",\n        "keyId": "550e8400-e29b-41d4-a716-446655440000",\n        "percentage": 0.80,\n        "remainingBudget": 400.00\n      }\n    ],\n    "budgetBreakdown": {\n      "byVirtualKey": [\n        {\n          "keyId": "550e8400-e29b-41d4-a716-446655440000",\n          "keyName": "Production API Key",\n          "maxBudget": 5000.00,\n          "currentSpend": 4000.00,\n          "utilizationPercentage": 0.80\n        }\n      ],\n      "byProvider": {\n        "openai": {\n          "spend": 22678.90,\n          "percentage": 0.705\n        },\n        "anthropic": {\n          "spend": 7890.12,\n          "percentage": 0.245\n        },\n        "google": {\n          "spend": 1576.65,\n          "percentage": 0.050\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"budget-alerts-and-enforcement",children:"Budget Alerts and Enforcement"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Configure Budget Alerts:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X PUT http://localhost:5002/api/admin/budgets/alerts \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "globalBudgetAlerts": {\n      "enabled": true,\n      "thresholds": [\n        {\n          "percentage": 0.7,\n          "actions": ["webhook", "email"],\n          "recipients": ["admin@company.com"],\n          "message": "Global budget 70% utilized"\n        },\n        {\n          "percentage": 0.9,\n          "actions": ["webhook", "email", "slack", "pagerduty"],\n          "recipients": ["admin@company.com"],\n          "channels": ["#alerts"],\n          "urgency": "high",\n          "message": "Global budget 90% utilized - immediate attention required"\n        }\n      ]\n    },\n    "virtualKeyBudgetAlerts": {\n      "enabled": true,\n      "defaultThresholds": [0.5, 0.8, 0.95],\n      "actions": {\n        "0.5": ["webhook"],\n        "0.8": ["webhook", "email"],\n        "0.95": ["webhook", "email", "disable_key"]\n      }\n    },\n    "costSpikesDetection": {\n      "enabled": true,\n      "thresholdMultiplier": 3.0,\n      "timeWindow": 3600,\n      "actions": ["webhook", "email"]\n    }\n  }\'\n'})}),"\n",(0,a.jsx)(n.h3,{id:"budget-forecasting",children:"Budget Forecasting"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Get Budget Forecasts:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/analytics/budget-forecast?horizon=90d"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "horizon": "90d",\n    "currentTrend": "increasing",\n    "confidenceLevel": 0.85,\n    "globalForecast": {\n      "projectedSpend": 156780.90,\n      "budgetRequired": 180000.00,\n      "overBudgetRisk": 0.15,\n      "recommendedBudget": 175000.00\n    },\n    "monthlyForecasts": [\n      {\n        "month": "2024-02",\n        "projectedSpend": 47890.12,\n        "confidence": 0.90,\n        "factors": ["historical_trend", "seasonal_adjustment"]\n      },\n      {\n        "month": "2024-03",\n        "projectedSpend": 52145.67,\n        "confidence": 0.82,\n        "factors": ["growth_trend", "new_virtual_keys"]\n      }\n    ],\n    "keyForecasts": [\n      {\n        "keyId": "550e8400-e29b-41d4-a716-446655440000",\n        "keyName": "Production API Key",\n        "projectedSpend": 6789.01,\n        "budgetRequired": 8000.00,\n        "riskLevel": "medium"\n      }\n    ],\n    "growthFactors": [\n      {\n        "factor": "increased_gpt4_usage",\n        "impact": 1234.56,\n        "confidence": 0.88\n      },\n      {\n        "factor": "new_audio_features",\n        "impact": 567.89,\n        "confidence": 0.72\n      }\n    ]\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"advanced-analytics",children:"Advanced Analytics"}),"\n",(0,a.jsx)(n.h3,{id:"usage-patterns-analysis",children:"Usage Patterns Analysis"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Get Usage Patterns:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/analytics/patterns?period=30d&analysis=detailed"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "period": "30d",\n    "patterns": {\n      "temporalPatterns": {\n        "peakHours": [9, 10, 11, 14, 15, 16],\n        "lowUsageHours": [0, 1, 2, 3, 4, 5],\n        "weekdayVsWeekend": {\n          "weekdayAverage": 45670,\n          "weekendAverage": 12345,\n          "ratio": 3.7\n        },\n        "seasonality": {\n          "detected": true,\n          "pattern": "business_hours",\n          "strength": 0.87\n        }\n      },\n      "usageDistribution": {\n        "powerUsers": {\n          "count": 12,\n          "percentage": 0.08,\n          "costContribution": 0.67\n        },\n        "mediumUsers": {\n          "count": 45,\n          "percentage": 0.30,\n          "costContribution": 0.28\n        },\n        "lightUsers": {\n          "count": 93,\n          "percentage": 0.62,\n          "costContribution": 0.05\n        }\n      },\n      "modelPreferences": {\n        "gpt-4": {\n          "usage": 0.45,\n          "growthTrend": "increasing",\n          "userSegments": ["power_users", "enterprise"]\n        },\n        "gpt-3.5-turbo": {\n          "usage": 0.35,\n          "growthTrend": "stable",\n          "userSegments": ["all"]\n        }\n      }\n    },\n    "anomalies": [\n      {\n        "type": "usage_spike",\n        "timestamp": "2024-01-14T15:30:00Z",\n        "description": "300% increase in GPT-4 usage",\n        "impact": "cost_increase",\n        "severity": "medium"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"performance-analytics",children:"Performance Analytics"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Get Performance Metrics:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/analytics/performance?period=7d&breakdown=provider"\n'})}),"\n",(0,a.jsx)(n.h2,{id:"data-export-and-integration",children:"Data Export and Integration"}),"\n",(0,a.jsx)(n.h3,{id:"export-usage-data",children:"Export Usage Data"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Export Detailed Usage Data:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/analytics/export" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "format": "csv",\n    "period": "30d",\n    "granularity": "hourly",\n    "includeFields": [\n      "timestamp",\n      "virtual_key_id",\n      "virtual_key_name",\n      "provider",\n      "model",\n      "operation",\n      "requests",\n      "tokens",\n      "cost",\n      "latency",\n      "errors"\n    ],\n    "filters": {\n      "virtualKeys": ["550e8400-e29b-41d4-a716-446655440000"],\n      "providers": ["openai", "anthropic"],\n      "minCost": 1.00\n    }\n  }\' > usage-export.csv\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Export for Billing Integration:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/analytics/billing-export" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "format": "json",\n    "period": "monthly",\n    "billingCycle": "2024-01",\n    "groupBy": "virtual_key",\n    "includeMetadata": true,\n    "includeTaxCalculations": true\n  }\' > billing-2024-01.json\n'})}),"\n",(0,a.jsx)(n.h3,{id:"integration-with-external-systems",children:"Integration with External Systems"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Webhook Configuration for Real-Time Data:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X PUT http://localhost:5002/api/admin/analytics/webhooks \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "enabled": true,\n    "endpoints": [\n      {\n        "url": "https://billing.company.com/webhooks/conduit",\n        "events": ["usage.recorded", "cost.calculated", "budget.exceeded"],\n        "authentication": {\n          "type": "bearer",\n          "token": "webhook-auth-token"\n        },\n        "retryPolicy": {\n          "maxRetries": 3,\n          "retryDelay": 5000\n        }\n      }\n    ],\n    "batchSettings": {\n      "enabled": true,\n      "batchSize": 100,\n      "flushInterval": 300\n    }\n  }\'\n'})}),"\n",(0,a.jsx)(n.h2,{id:"custom-reports",children:"Custom Reports"}),"\n",(0,a.jsx)(n.h3,{id:"creating-custom-reports",children:"Creating Custom Reports"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Generate Custom Analytics Report:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:5002/api/admin/analytics/reports \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "reportName": "Monthly Executive Summary",\n    "period": "30d",\n    "sections": [\n      {\n        "type": "summary",\n        "metrics": ["total_cost", "total_requests", "unique_users"]\n      },\n      {\n        "type": "breakdown",\n        "groupBy": "provider",\n        "metrics": ["cost", "requests", "latency"]\n      },\n      {\n        "type": "trends",\n        "granularity": "daily",\n        "metrics": ["cost", "requests"]\n      },\n      {\n        "type": "top_items",\n        "category": "virtual_keys",\n        "sortBy": "cost",\n        "limit": 10\n      }\n    ],\n    "filters": {\n      "excludeTestKeys": true,\n      "minCost": 10.00\n    },\n    "schedule": {\n      "frequency": "monthly",\n      "dayOfMonth": 1,\n      "recipients": ["admin@company.com", "finance@company.com"]\n    }\n  }\'\n'})}),"\n",(0,a.jsx)(n.h3,{id:"scheduled-reports",children:"Scheduled Reports"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Configure Automated Reports:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X PUT http://localhost:5002/api/admin/analytics/scheduled-reports \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "reports": [\n      {\n        "name": "Daily Operations Report",\n        "schedule": "daily",\n        "time": "09:00",\n        "timezone": "UTC",\n        "period": "24h",\n        "recipients": ["ops@company.com"],\n        "format": "pdf",\n        "sections": ["summary", "alerts", "top_usage"]\n      },\n      {\n        "name": "Weekly Cost Analysis",\n        "schedule": "weekly",\n        "dayOfWeek": "monday",\n        "time": "08:00",\n        "period": "7d",\n        "recipients": ["finance@company.com"],\n        "format": "excel",\n        "sections": ["cost_breakdown", "trends", "forecasts"]\n      }\n    ]\n  }\'\n'})}),"\n",(0,a.jsx)(n.h2,{id:"security-and-compliance",children:"Security and Compliance"}),"\n",(0,a.jsx)(n.h3,{id:"data-privacy",children:"Data Privacy"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Data Anonymization"}),": Personal identifiers removed from analytics"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Access Control"}),": Role-based access to usage data"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Audit Logging"}),": All data access logged"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"GDPR Compliance"}),": Data deletion and export capabilities"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"audit-trails",children:"Audit Trails"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-15T10:30:00Z",\n  "level": "Information",\n  "message": "Usage analytics accessed",\n  "properties": {\n    "operation": "Analytics.GetUsage",\n    "virtualKeyId": "550e8400-e29b-41d4-a716-446655440000",\n    "period": "30d",\n    "requestedBy": "admin",\n    "ipAddress": "192.168.1.100",\n    "correlationId": "req-abc123"\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,a.jsx)(n.h3,{id:"common-analytics-issues",children:"Common Analytics Issues"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Missing Usage Data:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Check data ingestion status\ncurl -H "Authorization: Bearer your-master-key" \\\n  http://localhost:5002/api/admin/analytics/ingestion-status\n\n# Verify data pipeline health\ncurl -H "Authorization: Bearer your-master-key" \\\n  http://localhost:5002/api/admin/analytics/pipeline-health\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Incorrect Cost Calculations:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Recalculate costs for specific period\ncurl -X POST http://localhost:5002/api/admin/analytics/recalculate-costs \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "startDate": "2024-01-01",\n    "endDate": "2024-01-31",\n    "virtualKeys": ["550e8400-e29b-41d4-a716-446655440000"]\n  }\'\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Performance Issues:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Check analytics query performance\ncurl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/analytics/performance-metrics"\n'})}),"\n",(0,a.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,a.jsx)(n.h3,{id:"usage-monitoring",children:"Usage Monitoring"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Regular Review"}),": Monitor usage patterns weekly"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Budget Alerts"}),": Set up proactive budget alerts"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Cost Optimization"}),": Review cost optimization recommendations monthly"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Anomaly Detection"}),": Enable automated anomaly detection"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Data Export"}),": Regular backups of usage data"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Caching"}),": Analytics data cached appropriately"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Aggregation"}),": Pre-computed aggregations for common queries"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Indexing"}),": Optimized database indexes for analytics queries"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Archiving"}),": Old data archived to reduce query complexity"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Provider Configuration"}),": Optimize ",(0,a.jsx)(n.a,{href:"provider-configuration",children:"provider settings"})," based on analytics"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Virtual Keys"}),": Adjust ",(0,a.jsx)(n.a,{href:"virtual-keys",children:"virtual key limits"})," based on usage patterns"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"WebUI Guide"}),": Use the ",(0,a.jsx)(n.a,{href:"webui-guide",children:"administrative interface"})," for visual analytics"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Core APIs"}),": Understand how usage is tracked in ",(0,a.jsx)(n.a,{href:"../core-apis/overview",children:"Core APIs"})]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var s=t(6540);const a={},r=s.createContext(a);function i(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);