"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6052],{7184:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"monitoring/runbooks","title":"Operational Runbooks","description":"This guide provides step-by-step procedures for common operational tasks and incident response scenarios in ConduitLLM production environments.","source":"@site/docs/monitoring/runbooks.md","sourceDirName":"monitoring","slug":"/monitoring/runbooks","permalink":"/Conduit/docs/monitoring/runbooks","draft":false,"unlisted":false,"editUrl":"https://github.com/knnlabs/Conduit/tree/main/website/docs/monitoring/runbooks.md","tags":[],"version":"current","frontMatter":{}}');var t=s(4848),r=s(8453);const c={},l="Operational Runbooks",a={},o=[{value:"Overview",id:"overview",level:2},{value:"Incident Response",id:"incident-response",level:2},{value:"High Error Rate",id:"high-error-rate",level:3},{value:"Database Connection Issues",id:"database-connection-issues",level:3},{value:"Memory Issues",id:"memory-issues",level:3},{value:"Maintenance Operations",id:"maintenance-operations",level:2},{value:"Rolling Updates",id:"rolling-updates",level:3},{value:"Database Maintenance",id:"database-maintenance",level:3},{value:"Certificate Renewal",id:"certificate-renewal",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Slow Response Times",id:"slow-response-times",level:3},{value:"High Latency to Providers",id:"high-latency-to-providers",level:3},{value:"Disaster Recovery",id:"disaster-recovery",level:2},{value:"Database Recovery",id:"database-recovery",level:3},{value:"Split-Brain Recovery",id:"split-brain-recovery",level:3},{value:"Monitoring and Alerting",id:"monitoring-and-alerting",level:2},{value:"Alert Response Matrix",id:"alert-response-matrix",level:3},{value:"On-Call Procedures",id:"on-call-procedures",level:3},{value:"Tools and Scripts",id:"tools-and-scripts",level:2},{value:"Health Check Script",id:"health-check-script",level:3},{value:"Quick Diagnostics",id:"quick-diagnostics",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"operational-runbooks",children:"Operational Runbooks"})}),"\n",(0,t.jsx)(n.p,{children:"This guide provides step-by-step procedures for common operational tasks and incident response scenarios in ConduitLLM production environments."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"These runbooks cover:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Incident response procedures"}),"\n",(0,t.jsx)(n.li,{children:"Common troubleshooting scenarios"}),"\n",(0,t.jsx)(n.li,{children:"Maintenance operations"}),"\n",(0,t.jsx)(n.li,{children:"Performance optimization"}),"\n",(0,t.jsx)(n.li,{children:"Disaster recovery"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"incident-response",children:"Incident Response"}),"\n",(0,t.jsx)(n.h3,{id:"high-error-rate",children:"High Error Rate"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Error rate above 5% for more than 5 minutes"}),"\n",(0,t.jsx)(n.li,{children:"Multiple user complaints"}),"\n",(0,t.jsx)(n.li,{children:"Alerts from monitoring system"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Investigation Steps:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Check System Health"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Check overall health\ncurl -s http://api.conduit.example.com/health/ready | jq\n\n# Check provider health\ncurl -s http://admin.conduit.example.com/api/admin/providers/health \\\n  -H "X-Master-Key: $MASTER_KEY" | jq\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Review Recent Logs"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Check API logs for errors\nkubectl logs -n conduit -l app=conduit-api --tail=100 | grep ERROR\n\n# Check specific provider errors\nkubectl logs -n conduit -l app=conduit-api --tail=1000 | \\\n  grep -E "(openai|anthropic|googlecloud)" | grep -i error\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Check Metrics"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Query Prometheus for error rates\ncurl -s "http://prometheus:9090/api/v1/query?query=rate(conduit_llm_requests_total{status=\'error\'}[5m])" | jq\n\n# Check provider-specific errors\ncurl -s "http://prometheus:9090/api/v1/query?query=conduit_provider_health" | jq\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Resolution Steps:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Provider Issues"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Disable unhealthy provider\ncurl -X PATCH http://admin.conduit.example.com/api/admin/providers/openai/disable \\\n  -H "X-Master-Key: $MASTER_KEY"\n\n# Force health check\ncurl -X POST http://admin.conduit.example.com/api/admin/providers/health/check \\\n  -H "X-Master-Key: $MASTER_KEY"\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Circuit Breaker Reset"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Reset circuit breaker for provider\ncurl -X POST http://admin.conduit.example.com/api/admin/providers/openai/reset-circuit \\\n  -H "X-Master-Key: $MASTER_KEY"\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Scale Up if Needed"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Increase replicas\nkubectl scale deployment conduit-api -n conduit --replicas=10\n\n# Or update HPA\nkubectl patch hpa conduit-api-hpa -n conduit \\\n  -p \'{"spec":{"minReplicas":5,"maxReplicas":30}}\'\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"database-connection-issues",children:"Database Connection Issues"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:'"Database connection failed" in health checks'}),"\n",(0,t.jsx)(n.li,{children:"Timeout errors in logs"}),"\n",(0,t.jsx)(n.li,{children:"Slow response times"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Investigation Steps:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Check Database Status"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Check PostgreSQL pod status\nkubectl get pods -n conduit -l app=postgres\n\n# Check connection pool stats\nkubectl exec -n conduit postgres-0 -- psql -U conduit -c \\\n  "SELECT count(*) as total, state FROM pg_stat_activity GROUP BY state;"\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Review Connection Limits"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Check max connections\nkubectl exec -n conduit postgres-0 -- psql -U conduit -c \\\n  "SHOW max_connections;"\n\n# Check current connections\nkubectl exec -n conduit postgres-0 -- psql -U conduit -c \\\n  "SELECT count(*) FROM pg_stat_activity;"\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Resolution Steps:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Kill Idle Connections"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- Terminate idle connections older than 5 minutes\nSELECT pg_terminate_backend(pid) \nFROM pg_stat_activity \nWHERE state = 'idle' \nAND state_change < NOW() - INTERVAL '5 minutes'\nAND datname = 'conduit';\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Restart Connection Pool"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Rolling restart of API pods\nkubectl rollout restart deployment conduit-api -n conduit\n\n# Monitor rollout\nkubectl rollout status deployment conduit-api -n conduit\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Increase Connection Limits"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Update PostgreSQL config\nkubectl exec -n conduit postgres-0 -- psql -U postgres -c \\\n  "ALTER SYSTEM SET max_connections = 500;"\n\n# Restart PostgreSQL\nkubectl delete pod -n conduit postgres-0\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"memory-issues",children:"Memory Issues"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"OutOfMemoryError in logs"}),"\n",(0,t.jsx)(n.li,{children:"Pods being killed (OOMKilled)"}),"\n",(0,t.jsx)(n.li,{children:"Degraded performance"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Investigation Steps:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Check Memory Usage"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Current memory usage\nkubectl top pods -n conduit\n\n# Historical memory usage\ncurl -s \"http://prometheus:9090/api/v1/query_range?query=container_memory_usage_bytes{namespace='conduit'}\" | jq\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Identify Memory Leaks"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Check for increasing memory over time\nkubectl exec -n conduit conduit-api-xxxx -- \\\n  curl -s http://localhost:8080/metrics | grep dotnet_gc\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Resolution Steps:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Immediate Relief"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Restart affected pods\nkubectl delete pod -n conduit conduit-api-xxxx\n\n# Increase memory limits temporarily\nkubectl set resources deployment conduit-api -n conduit \\\n  --limits=memory=4Gi --requests=memory=2Gi\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Cache Cleanup"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Clear Redis cache\nkubectl exec -n conduit redis-0 -- redis-cli FLUSHDB\n\n# Clear specific cache patterns\nkubectl exec -n conduit redis-0 -- redis-cli --scan --pattern "cache:*" | \\\n  xargs kubectl exec -n conduit redis-0 -- redis-cli DEL\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"maintenance-operations",children:"Maintenance Operations"}),"\n",(0,t.jsx)(n.h3,{id:"rolling-updates",children:"Rolling Updates"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Pre-deployment Checklist:"})}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Backup database"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Check current system health"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Notify users of maintenance window"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Prepare rollback plan"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Deployment Steps:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Create Backup"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Trigger manual backup\nkubectl create job -n conduit manual-backup-$(date +%Y%m%d-%H%M%S) \\\n  --from=cronjob/postgres-backup\n\n# Verify backup completed\nkubectl logs -n conduit -l job-name=manual-backup-* --tail=100\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Deploy New Version"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Update image\nkubectl set image deployment/conduit-api -n conduit \\\n  api=your-registry/conduit:v1.2.3\n\n# Monitor rollout\nkubectl rollout status deployment conduit-api -n conduit\n\n# Check pod status\nkubectl get pods -n conduit -l app=conduit-api -w\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Verify Deployment"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Check health\ncurl -s http://api.conduit.example.com/health/ready | jq\n\n# Run smoke tests\n./scripts/smoke-tests.sh\n\n# Check metrics\ncurl -s http://api.conduit.example.com/metrics | grep conduit_\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Rollback if Needed:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Rollback to previous version\nkubectl rollout undo deployment conduit-api -n conduit\n\n# Or rollback to specific revision\nkubectl rollout undo deployment conduit-api -n conduit --to-revision=2\n"})}),"\n",(0,t.jsx)(n.h3,{id:"database-maintenance",children:"Database Maintenance"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Regular Maintenance Tasks:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Vacuum and Analyze"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- Run vacuum analyze\nVACUUM ANALYZE;\n\n-- Check table sizes\nSELECT \n  schemaname,\n  tablename,\n  pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) as size\nFROM pg_tables \nWHERE schemaname = 'public' \nORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Index Maintenance"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- Find unused indexes\nSELECT \n  schemaname, \n  tablename, \n  indexname, \n  idx_scan\nFROM pg_stat_user_indexes \nWHERE idx_scan = 0 \nAND schemaname = 'public';\n\n-- Rebuild bloated indexes\nREINDEX TABLE request_logs;\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Archive Old Data"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- Archive logs older than 90 days\nINSERT INTO request_logs_archive \nSELECT * FROM request_logs \nWHERE timestamp < NOW() - INTERVAL '90 days';\n\n-- Delete archived records\nDELETE FROM request_logs \nWHERE timestamp < NOW() - INTERVAL '90 days';\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"certificate-renewal",children:"Certificate Renewal"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Check Certificate Expiration:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Check ingress certificates\nkubectl get certificate -n conduit\n\n# Check certificate details\nkubectl describe certificate conduit-tls -n conduit\n\n# Manual check\necho | openssl s_client -servername api.conduit.example.com \\\n  -connect api.conduit.example.com:443 2>/dev/null | \\\n  openssl x509 -noout -dates\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Renew Certificates:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Force renewal with cert-manager\nkubectl delete certificate conduit-tls -n conduit\n\n# Monitor renewal\nkubectl logs -n cert-manager deployment/cert-manager -f\n\n# Verify new certificate\nkubectl get certificate conduit-tls -n conduit\n"})}),"\n",(0,t.jsx)(n.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,t.jsx)(n.h3,{id:"slow-response-times",children:"Slow Response Times"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Investigation:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Identify Slow Queries"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- Find slow queries\nSELECT \n  query,\n  mean_exec_time,\n  calls,\n  total_exec_time\nFROM pg_stat_statements \nORDER BY mean_exec_time DESC \nLIMIT 20;\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Check Cache Performance"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Redis stats\nkubectl exec -n conduit redis-0 -- redis-cli INFO stats\n\n# Cache hit rate\ncurl -s "http://prometheus:9090/api/v1/query?query=rate(conduit_cache_hits_total[5m])" | jq\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Optimization Steps:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Database Tuning"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- Add missing indexes\nCREATE INDEX CONCURRENTLY idx_request_logs_timestamp \nON request_logs(timestamp);\n\n-- Update statistics\nANALYZE request_logs;\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Cache Warming"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Warm popular models cache\ncurl -X POST http://admin.conduit.example.com/api/admin/cache/warm \\\n  -H "X-Master-Key: $MASTER_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{"models": ["gpt-4", "claude-3-opus"]}\'\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"high-latency-to-providers",children:"High Latency to Providers"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Investigation:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Check provider latencies\ncurl -s "http://prometheus:9090/api/v1/query?query=conduit_provider_response_time_seconds" | jq\n\n# Test direct connectivity\ncurl -w "@curl-format.txt" -o /dev/null -s https://api.openai.com/v1/models\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Resolution:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Enable Regional Routing"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Configure regional endpoints\ncurl -X POST http://admin.conduit.example.com/api/admin/providers/config \\\n  -H "X-Master-Key: $MASTER_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "provider": "openai",\n    "regionalEndpoints": {\n      "us-east": "https://api.openai.com",\n      "eu-west": "https://eu.api.openai.com"\n    }\n  }\'\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"disaster-recovery",children:"Disaster Recovery"}),"\n",(0,t.jsx)(n.h3,{id:"database-recovery",children:"Database Recovery"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"From Backup:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# List available backups\naws s3 ls s3://conduit-backups/ | grep sql.gz\n\n# Download backup\naws s3 cp s3://conduit-backups/conduit-20240115-020000.sql.gz .\n\n# Restore database\ngunzip -c conduit-20240115-020000.sql.gz | \\\n  kubectl exec -i -n conduit postgres-0 -- psql -U conduit\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Point-in-Time Recovery:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Stop application\nkubectl scale deployment conduit-api -n conduit --replicas=0\n\n# Restore to specific time\nkubectl exec -n conduit postgres-0 -- pg_restore \\\n  --dbname=conduit \\\n  --target-time="2024-01-15 10:30:00" \\\n  /backup/base.tar\n\n# Restart application\nkubectl scale deployment conduit-api -n conduit --replicas=3\n'})}),"\n",(0,t.jsx)(n.h3,{id:"split-brain-recovery",children:"Split-Brain Recovery"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Identify Split-Brain:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Check Redis cluster status\nkubectl exec -n conduit redis-0 -- redis-cli CLUSTER NODES\n\n# Check for multiple masters\nkubectl exec -n conduit redis-0 -- redis-cli CLUSTER INFO\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Resolution:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Force failover to single master\nkubectl exec -n conduit redis-1 -- redis-cli CLUSTER FAILOVER FORCE\n\n# Reset cluster if needed\nkubectl exec -n conduit redis-0 -- redis-cli CLUSTER RESET HARD\n"})}),"\n",(0,t.jsx)(n.h2,{id:"monitoring-and-alerting",children:"Monitoring and Alerting"}),"\n",(0,t.jsx)(n.h3,{id:"alert-response-matrix",children:"Alert Response Matrix"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Alert"}),(0,t.jsx)(n.th,{children:"Severity"}),(0,t.jsx)(n.th,{children:"Response Time"}),(0,t.jsx)(n.th,{children:"Actions"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Provider Down"}),(0,t.jsx)(n.td,{children:"Critical"}),(0,t.jsx)(n.td,{children:"5 min"}),(0,t.jsx)(n.td,{children:"Disable provider, notify on-call"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"High Error Rate"}),(0,t.jsx)(n.td,{children:"High"}),(0,t.jsx)(n.td,{children:"15 min"}),(0,t.jsx)(n.td,{children:"Check logs, scale up if needed"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Database Connection Pool Exhausted"}),(0,t.jsx)(n.td,{children:"High"}),(0,t.jsx)(n.td,{children:"10 min"}),(0,t.jsx)(n.td,{children:"Kill idle connections, restart pods"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Memory > 90%"}),(0,t.jsx)(n.td,{children:"Medium"}),(0,t.jsx)(n.td,{children:"30 min"}),(0,t.jsx)(n.td,{children:"Clear cache, increase limits"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Disk > 80%"}),(0,t.jsx)(n.td,{children:"Medium"}),(0,t.jsx)(n.td,{children:"1 hour"}),(0,t.jsx)(n.td,{children:"Archive old data, expand volume"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Certificate Expiring"}),(0,t.jsx)(n.td,{children:"Low"}),(0,t.jsx)(n.td,{children:"1 day"}),(0,t.jsx)(n.td,{children:"Renew certificate"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"on-call-procedures",children:"On-Call Procedures"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Initial Response:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Acknowledge alert within 5 minutes"}),"\n",(0,t.jsx)(n.li,{children:"Join incident channel"}),"\n",(0,t.jsx)(n.li,{children:"Run initial diagnostics"}),"\n",(0,t.jsx)(n.li,{children:"Escalate if needed"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Communication:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Update status page"}),"\n",(0,t.jsx)(n.li,{children:"Notify stakeholders"}),"\n",(0,t.jsx)(n.li,{children:"Document actions in incident channel"}),"\n",(0,t.jsx)(n.li,{children:"Create post-mortem ticket"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"tools-and-scripts",children:"Tools and Scripts"}),"\n",(0,t.jsx)(n.h3,{id:"health-check-script",children:"Health Check Script"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n# check-health.sh\n\necho "=== System Health Check ==="\necho "Timestamp: $(date)"\n\n# API Health\necho -e "\\n--- API Health ---"\ncurl -s http://api.conduit.example.com/health/ready | jq\n\n# Provider Health  \necho -e "\\n--- Provider Health ---"\ncurl -s http://admin.conduit.example.com/api/admin/providers/health \\\n  -H "X-Master-Key: $MASTER_KEY" | jq\n\n# Database Status\necho -e "\\n--- Database Status ---"\nkubectl exec -n conduit postgres-0 -- psql -U conduit -c \\\n  "SELECT count(*) as connections, state FROM pg_stat_activity GROUP BY state;"\n\n# Redis Status\necho -e "\\n--- Redis Status ---"\nkubectl exec -n conduit redis-0 -- redis-cli INFO server | grep uptime\n\n# Pod Status\necho -e "\\n--- Pod Status ---"\nkubectl get pods -n conduit\n'})}),"\n",(0,t.jsx)(n.h3,{id:"quick-diagnostics",children:"Quick Diagnostics"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n# diagnose.sh\n\n# Recent errors\necho "=== Recent Errors ==="\nkubectl logs -n conduit -l app=conduit-api --tail=1000 | \\\n  grep ERROR | tail -20\n\n# Current metrics\necho -e "\\n=== Current Metrics ==="\ncurl -s http://api.conduit.example.com/metrics | \\\n  grep -E "(conduit_llm_requests_total|conduit_llm_active_requests)"\n\n# Resource usage\necho -e "\\n=== Resource Usage ==="\nkubectl top pods -n conduit\n'})}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/Conduit/docs/monitoring/health-checks",children:"Health Checks"})," - Configure health monitoring"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/Conduit/docs/monitoring/metrics-monitoring",children:"Metrics Monitoring"})," - Set up alerting"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/Conduit/docs/monitoring/production-deployment",children:"Production Deployment"})," - Deployment procedures"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/Conduit/docs/troubleshooting/common-issues",children:"Troubleshooting Guide"})," - Common issues"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>l});var i=s(6540);const t={},r=i.createContext(t);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);