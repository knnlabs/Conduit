"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8122],{8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>l});var t=i(6540);const a={},r=t.createContext(a);function s(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(r.Provider,{value:n},e.children)}},9480:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"admin/virtual-keys","title":"Virtual Keys Management","description":"Comprehensive guide to managing virtual keys through the Admin API","source":"@site/docs/admin/virtual-keys.md","sourceDirName":"admin","slug":"/admin/virtual-keys","permalink":"/Conduit/docs/admin/virtual-keys","draft":false,"unlisted":false,"editUrl":"https://github.com/knnlabs/Conduit/tree/main/website/docs/admin/virtual-keys.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Virtual Keys Management","description":"Comprehensive guide to managing virtual keys through the Admin API"},"sidebar":"docsSidebar","previous":{"title":"Admin API Overview","permalink":"/Conduit/docs/admin/admin-api-overview"},"next":{"title":"Provider Configuration","permalink":"/Conduit/docs/admin/provider-configuration"}}');var a=i(4848),r=i(8453);const s={sidebar_position:2,title:"Virtual Keys Management",description:"Comprehensive guide to managing virtual keys through the Admin API"},l="Virtual Keys Management",o={},d=[{value:"Virtual Key Architecture",id:"virtual-key-architecture",level:2},{value:"Key Components",id:"key-components",level:3},{value:"Security Model",id:"security-model",level:3},{value:"Creating Virtual Keys",id:"creating-virtual-keys",level:2},{value:"Basic Virtual Key Creation",id:"basic-virtual-key-creation",level:3},{value:"Advanced Virtual Key Configuration",id:"advanced-virtual-key-configuration",level:3},{value:"Virtual Key Configuration Options",id:"virtual-key-configuration-options",level:2},{value:"Permission Settings",id:"permission-settings",level:3},{value:"Rate Limiting Configuration",id:"rate-limiting-configuration",level:3},{value:"Budget Management",id:"budget-management",level:3},{value:"Virtual Key Operations",id:"virtual-key-operations",level:2},{value:"Retrieving Virtual Keys",id:"retrieving-virtual-keys",level:3},{value:"Updating Virtual Keys",id:"updating-virtual-keys",level:3},{value:"Key Rotation and Security",id:"key-rotation-and-security",level:3},{value:"Usage Analytics and Monitoring",id:"usage-analytics-and-monitoring",level:2},{value:"Usage Statistics",id:"usage-statistics",level:3},{value:"Cost Analysis",id:"cost-analysis",level:3},{value:"Real-Time Monitoring",id:"real-time-monitoring",level:3},{value:"Bulk Operations",id:"bulk-operations",level:2},{value:"Bulk Virtual Key Creation",id:"bulk-virtual-key-creation",level:3},{value:"Bulk Updates",id:"bulk-updates",level:3},{value:"Bulk Export/Import",id:"bulk-exportimport",level:3},{value:"Alert Configuration",id:"alert-configuration",level:2},{value:"Budget Alerts",id:"budget-alerts",level:3},{value:"Usage Alerts",id:"usage-alerts",level:3},{value:"Event-Driven Updates",id:"event-driven-updates",level:2},{value:"Virtual Key Events",id:"virtual-key-events",level:3},{value:"Cache Invalidation",id:"cache-invalidation",level:3},{value:"Security Best Practices",id:"security-best-practices",level:2},{value:"Key Generation",id:"key-generation",level:3},{value:"Access Control",id:"access-control",level:3},{value:"Audit Logging",id:"audit-logging",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Caching Strategy",id:"caching-strategy",level:3},{value:"Database Optimization",id:"database-optimization",level:3},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"virtual-keys-management",children:"Virtual Keys Management"})}),"\n",(0,a.jsx)(n.p,{children:"Virtual keys are the primary access control mechanism in Conduit, providing secure, configurable API access with granular permissions, rate limiting, and cost controls. This guide covers complete virtual key lifecycle management through the Admin API."}),"\n",(0,a.jsx)(n.h2,{id:"virtual-key-architecture",children:"Virtual Key Architecture"}),"\n",(0,a.jsx)(n.h3,{id:"key-components",children:"Key Components"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Key Hash"}),": Unique identifier for caching and logging (first 8 characters)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Full Key"}),": Complete API key starting with ",(0,a.jsx)(n.code,{children:"condt_"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Permissions"}),": Model access, operation types, rate limits"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Budget Controls"}),": Spending limits and alerts"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Usage Tracking"}),": Real-time consumption monitoring"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"security-model",children:"Security Model"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Request Flow:\nClient \u2192 Virtual Key \u2192 Validation \u2192 Provider \u2192 Response\n         \u2193\n    Rate Limiting + Budget Check + Permissions\n"})}),"\n",(0,a.jsx)(n.h2,{id:"creating-virtual-keys",children:"Creating Virtual Keys"}),"\n",(0,a.jsx)(n.h3,{id:"basic-virtual-key-creation",children:"Basic Virtual Key Creation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:5002/api/admin/virtual-keys \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "name": "Production API Key",\n    "description": "Main API key for production environment",\n    "isEnabled": true\n  }\'\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "id": "550e8400-e29b-41d4-a716-446655440000",\n    "key": "condt_pk_1234567890abcdef...",\n    "keyHash": "abcd1234",\n    "name": "Production API Key",\n    "description": "Main API key for production environment",\n    "isEnabled": true,\n    "createdAt": "2024-01-15T10:30:00Z",\n    "createdBy": "admin",\n    "lastUsed": null,\n    "totalRequests": 0,\n    "totalSpent": 0.0\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"advanced-virtual-key-configuration",children:"Advanced Virtual Key Configuration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:5002/api/admin/virtual-keys \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "name": "Development Team Key",\n    "description": "API key for development team with specific model access",\n    "isEnabled": true,\n    "maxBudget": 500.00,\n    "budgetPeriod": "monthly",\n    "budgetAlertThresholds": [0.5, 0.8, 0.9],\n    "allowedModels": [\n      "gpt-3.5-turbo",\n      "gpt-4",\n      "claude-3-haiku",\n      "claude-3-sonnet"\n    ],\n    "allowedOperations": [\n      "chat.completions",\n      "embeddings",\n      "audio.transcriptions"\n    ],\n    "rateLimit": {\n      "requestsPerMinute": 1000,\n      "requestsPerHour": 50000,\n      "requestsPerDay": 100000,\n      "tokensPerMinute": 100000,\n      "tokensPerDay": 1000000\n    },\n    "ipAllowlist": [\n      "192.168.1.0/24",\n      "10.0.0.0/8"\n    ],\n    "metadata": {\n      "team": "development",\n      "environment": "staging",\n      "project": "conduit-integration"\n    },\n    "webhookUrl": "https://your-app.com/webhooks/conduit",\n    "webhookEvents": [\n      "budget.threshold.reached",\n      "rate.limit.exceeded",\n      "key.disabled"\n    ]\n  }\'\n'})}),"\n",(0,a.jsx)(n.h2,{id:"virtual-key-configuration-options",children:"Virtual Key Configuration Options"}),"\n",(0,a.jsx)(n.h3,{id:"permission-settings",children:"Permission Settings"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Model Access Control:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "allowedModels": [\n    "gpt-4",                    // Specific model\n    "gpt-3.5-turbo*",          // Wildcard matching\n    "claude-3-*",              // Family matching\n    "anthropic/*"              // Provider matching\n  ],\n  "deniedModels": [\n    "gpt-4-32k",               // Expensive models\n    "claude-3-opus"            // High-cost models\n  ]\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Operation Restrictions:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "allowedOperations": [\n    "chat.completions",         // Text generation\n    "embeddings",              // Vector embeddings\n    "audio.transcriptions",    // Speech-to-text\n    "audio.speech",            // Text-to-speech\n    "images.generations"       // Image generation\n  ],\n  "deniedOperations": [\n    "audio.realtime",          // Real-time audio (expensive)\n    "video.generations"        // Video generation (very expensive)\n  ]\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"rate-limiting-configuration",children:"Rate Limiting Configuration"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Comprehensive Rate Limits:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "rateLimit": {\n    "requestsPerMinute": 1000,\n    "requestsPerHour": 50000,\n    "requestsPerDay": 500000,\n    "requestsPerMonth": 10000000,\n    \n    "tokensPerMinute": 100000,\n    "tokensPerHour": 5000000,\n    "tokensPerDay": 50000000,\n    \n    "costPerMinute": 10.00,\n    "costPerHour": 500.00,\n    "costPerDay": 5000.00,\n    \n    "concurrentRequests": 100,\n    "burstMultiplier": 2.0,\n    "slidingWindow": true\n  }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Rate Limit Enforcement:"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Sliding Window"}),": More accurate than fixed windows"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Burst Allowance"}),": Temporary spikes up to ",(0,a.jsx)(n.code,{children:"burstMultiplier"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Concurrent Limits"}),": Maximum simultaneous requests"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Cost-Based Limiting"}),": Budget-aware rate limiting"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"budget-management",children:"Budget Management"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Budget Configuration:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "maxBudget": 1000.00,\n  "budgetPeriod": "monthly",        // daily, weekly, monthly, yearly\n  "budgetResetDay": 1,              // Day of month for reset\n  "budgetAlertThresholds": [\n    0.5,                            // 50% threshold\n    0.8,                            // 80% threshold  \n    0.9,                            // 90% threshold\n    0.95                            // 95% threshold\n  ],\n  "budgetExceededAction": "disable", // disable, warn, continue\n  "budgetGracePeriod": 24,          // Hours before enforcement\n  "autoBudgetIncrease": {\n    "enabled": false,\n    "maxIncrease": 2.0,             // 2x original budget\n    "incrementPercentage": 0.1       // 10% increases\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"virtual-key-operations",children:"Virtual Key Operations"}),"\n",(0,a.jsx)(n.h3,{id:"retrieving-virtual-keys",children:"Retrieving Virtual Keys"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"List All Virtual Keys:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys?page=1&pageSize=50&sortBy=createdAt&sortOrder=desc"\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Filter Virtual Keys:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Active keys only\ncurl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys?isEnabled=true"\n\n# Keys with budget limits\ncurl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys?hasMaxBudget=true"\n\n# Keys created in date range\ncurl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys?createdAfter=2024-01-01&createdBefore=2024-12-31"\n\n# Search by name/description\ncurl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys?search=production"\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Get Specific Virtual Key:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000\n'})}),"\n",(0,a.jsx)(n.h3,{id:"updating-virtual-keys",children:"Updating Virtual Keys"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Partial Update:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000 \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "maxBudget": 2000.00,\n    "rateLimit": {\n      "requestsPerMinute": 2000\n    }\n  }\'\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Complete Update:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X PUT http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000 \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "name": "Updated Production Key",\n    "description": "Updated description",\n    "isEnabled": true,\n    "maxBudget": 2000.00,\n    "allowedModels": ["gpt-4", "claude-3-sonnet"],\n    "rateLimit": {\n      "requestsPerMinute": 2000,\n      "requestsPerDay": 1000000\n    }\n  }\'\n'})}),"\n",(0,a.jsx)(n.h3,{id:"key-rotation-and-security",children:"Key Rotation and Security"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Regenerate Virtual Key:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/regenerate \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "invalidateOldKey": false,      // Keep old key active temporarily\n    "gracePeriodHours": 24          // Hours before old key expires\n  }\'\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "id": "550e8400-e29b-41d4-a716-446655440000",\n    "newKey": "condt_pk_new_key_here...",\n    "oldKey": "condt_pk_old_key_here...",\n    "oldKeyExpiresAt": "2024-01-16T10:30:00Z",\n    "regeneratedAt": "2024-01-15T10:30:00Z"\n  }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Disable/Enable Virtual Key:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Disable key\ncurl -X POST http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/disable \\\n  -H "Authorization: Bearer your-master-key"\n\n# Enable key\ncurl -X POST http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/enable \\\n  -H "Authorization: Bearer your-master-key"\n'})}),"\n",(0,a.jsx)(n.h2,{id:"usage-analytics-and-monitoring",children:"Usage Analytics and Monitoring"}),"\n",(0,a.jsx)(n.h3,{id:"usage-statistics",children:"Usage Statistics"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Get Usage Summary:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/usage?period=7d"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "keyId": "550e8400-e29b-41d4-a716-446655440000",\n    "period": "7d",\n    "summary": {\n      "totalRequests": 15420,\n      "successfulRequests": 15180,\n      "failedRequests": 240,\n      "totalTokens": 2456780,\n      "inputTokens": 1234567,\n      "outputTokens": 1222213,\n      "totalCost": 234.56,\n      "averageLatency": 1.23,\n      "errorRate": 0.0156\n    },\n    "breakdown": {\n      "byModel": {\n        "gpt-4": {\n          "requests": 8920,\n          "tokens": 1456780,\n          "cost": 187.23\n        },\n        "gpt-3.5-turbo": {\n          "requests": 6500,\n          "tokens": 1000000,\n          "cost": 47.33\n        }\n      },\n      "byProvider": {\n        "openai": {\n          "requests": 15420,\n          "cost": 234.56,\n          "averageLatency": 1.23\n        }\n      },\n      "byOperation": {\n        "chat.completions": {\n          "requests": 14200,\n          "cost": 220.45\n        },\n        "embeddings": {\n          "requests": 1220,\n          "cost": 14.11\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Detailed Usage History:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/usage/detailed?startDate=2024-01-01&endDate=2024-01-31&groupBy=day"\n'})}),"\n",(0,a.jsx)(n.h3,{id:"cost-analysis",children:"Cost Analysis"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Cost Breakdown:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/costs?period=30d&groupBy=model"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "totalCost": 1234.56,\n    "budgetUtilization": 0.62,\n    "remainingBudget": 765.44,\n    "projectedMonthlyCost": 1987.34,\n    "costTrend": "increasing",\n    "breakdown": {\n      "byModel": {\n        "gpt-4": {\n          "cost": 987.23,\n          "percentage": 0.8,\n          "requests": 25680,\n          "avgCostPerRequest": 0.0384\n        },\n        "gpt-3.5-turbo": {\n          "cost": 247.33,\n          "percentage": 0.2,\n          "requests": 15420,\n          "avgCostPerRequest": 0.0160\n        }\n      },\n      "dailyTrend": [\n        {\n          "date": "2024-01-01",\n          "cost": 42.15,\n          "requests": 1234\n        }\n      ]\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"real-time-monitoring",children:"Real-Time Monitoring"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Current Usage Status:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/status"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "keyId": "550e8400-e29b-41d4-a716-446655440000",\n    "isEnabled": true,\n    "isHealthy": true,\n    "lastUsed": "2024-01-15T10:25:00Z",\n    "currentPeriod": {\n      "startDate": "2024-01-01T00:00:00Z",\n      "endDate": "2024-01-31T23:59:59Z",\n      "budgetUsed": 789.23,\n      "budgetRemaining": 210.77,\n      "budgetUtilization": 0.789\n    },\n    "rateLimitStatus": {\n      "requestsThisMinute": 45,\n      "requestsThisHour": 2340,\n      "requestsThisDay": 15420,\n      "tokensThisMinute": 15680,\n      "remainingRequests": {\n        "perMinute": 955,\n        "perHour": 47660,\n        "perDay": 84580\n      }\n    },\n    "recentActivity": {\n      "lastRequest": "2024-01-15T10:25:00Z",\n      "recentErrors": 3,\n      "averageLatency": 1.23\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"bulk-operations",children:"Bulk Operations"}),"\n",(0,a.jsx)(n.h3,{id:"bulk-virtual-key-creation",children:"Bulk Virtual Key Creation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:5002/api/admin/virtual-keys/bulk \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "keys": [\n      {\n        "name": "Team Alpha Key",\n        "description": "API key for Team Alpha",\n        "maxBudget": 500.00,\n        "allowedModels": ["gpt-3.5-turbo", "claude-3-haiku"]\n      },\n      {\n        "name": "Team Beta Key", \n        "description": "API key for Team Beta",\n        "maxBudget": 1000.00,\n        "allowedModels": ["gpt-4", "claude-3-sonnet"]\n      }\n    ],\n    "commonSettings": {\n      "budgetPeriod": "monthly",\n      "rateLimit": {\n        "requestsPerMinute": 1000,\n        "requestsPerDay": 100000\n      },\n      "webhookUrl": "https://your-app.com/webhooks/conduit"\n    }\n  }\'\n'})}),"\n",(0,a.jsx)(n.h3,{id:"bulk-updates",children:"Bulk Updates"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH http://localhost:5002/api/admin/virtual-keys/bulk \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "keyIds": [\n      "550e8400-e29b-41d4-a716-446655440000",\n      "550e8400-e29b-41d4-a716-446655440001"\n    ],\n    "updates": {\n      "maxBudget": 2000.00,\n      "rateLimit": {\n        "requestsPerMinute": 2000\n      }\n    }\n  }\'\n'})}),"\n",(0,a.jsx)(n.h3,{id:"bulk-exportimport",children:"Bulk Export/Import"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Export Virtual Keys:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/export?format=json&includeUsage=true" > virtual-keys-backup.json\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Import Virtual Keys:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:5002/api/admin/virtual-keys/import \\\n  -H "Authorization: Bearer your-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d @virtual-keys-backup.json\n'})}),"\n",(0,a.jsx)(n.h2,{id:"alert-configuration",children:"Alert Configuration"}),"\n",(0,a.jsx)(n.h3,{id:"budget-alerts",children:"Budget Alerts"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "budgetAlerts": {\n    "enabled": true,\n    "thresholds": [\n      {\n        "percentage": 0.5,\n        "actions": ["webhook", "email"],\n        "recipients": ["admin@company.com"]\n      },\n      {\n        "percentage": 0.8,\n        "actions": ["webhook", "email", "slack"],\n        "channels": ["#alerts"]\n      },\n      {\n        "percentage": 0.9,\n        "actions": ["webhook", "email", "slack", "pagerduty"],\n        "urgency": "high"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"usage-alerts",children:"Usage Alerts"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "usageAlerts": {\n    "rateLimitApproaching": {\n      "threshold": 0.8,\n      "window": "1m",\n      "actions": ["webhook"]\n    },\n    "unusualUsagePattern": {\n      "enabled": true,\n      "threshold": 3.0,\n      "actions": ["email", "webhook"]\n    },\n    "keyNotUsed": {\n      "days": 7,\n      "actions": ["email"]\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"event-driven-updates",children:"Event-Driven Updates"}),"\n",(0,a.jsx)(n.h3,{id:"virtual-key-events",children:"Virtual Key Events"}),"\n",(0,a.jsx)(n.p,{children:"When virtual keys are modified through the Admin API, events are published for real-time coordination:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "eventType": "VirtualKeyUpdated",\n  "keyId": "550e8400-e29b-41d4-a716-446655440000",\n  "keyHash": "abcd1234",\n  "timestamp": "2024-01-15T10:30:00Z",\n  "changedProperties": [\n    "maxBudget",\n    "rateLimit.requestsPerMinute"\n  ],\n  "data": {\n    "maxBudget": 2000.00,\n    "rateLimit": {\n      "requestsPerMinute": 2000\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"cache-invalidation",children:"Cache Invalidation"}),"\n",(0,a.jsx)(n.p,{children:"Virtual key changes trigger immediate cache invalidation across all Core API instances:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Admin API publishes ",(0,a.jsx)(n.code,{children:"VirtualKeyUpdated"})," event"]}),"\n",(0,a.jsx)(n.li,{children:"Core API instances receive event via RabbitMQ"}),"\n",(0,a.jsx)(n.li,{children:"Redis cache entries invalidated immediately"}),"\n",(0,a.jsx)(n.li,{children:"Next request loads fresh data from database"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"security-best-practices",children:"Security Best Practices"}),"\n",(0,a.jsx)(n.h3,{id:"key-generation",children:"Key Generation"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Cryptographically Secure"}),": Keys use secure random generation"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Prefix Identification"}),": All keys start with ",(0,a.jsx)(n.code,{children:"condt_"})," for easy identification"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Hash-Based Caching"}),": Only key hash stored in logs and cache"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"access-control",children:"Access Control"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "securitySettings": {\n    "ipAllowlist": [\n      "192.168.1.0/24",\n      "10.0.0.0/8"\n    ],\n    "ipDenylist": [\n      "192.168.100.0/24"\n    ],\n    "requireHttps": true,\n    "allowedUserAgents": [\n      "MyApp/1.0",\n      "Python/3.9"\n    ],\n    "blockedUserAgents": [\n      "curl/7.68.0"\n    ]\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"audit-logging",children:"Audit Logging"}),"\n",(0,a.jsx)(n.p,{children:"All virtual key operations are logged:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-15T10:30:00Z",\n  "level": "Information",\n  "message": "Virtual key updated",\n  "properties": {\n    "operation": "VirtualKey.Update",\n    "keyId": "550e8400-e29b-41d4-a716-446655440000",\n    "keyHash": "abcd1234",\n    "changedFields": ["maxBudget", "rateLimit"],\n    "performedBy": "admin",\n    "ipAddress": "192.168.1.100",\n    "correlationId": "req-abc123"\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,a.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Virtual Key Not Working:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Check key status\ncurl -H "Authorization: Bearer your-master-key" \\\n  http://localhost:5002/api/admin/virtual-keys/search?key=condt_pk_partial_key\n\n# Check recent usage\ncurl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/usage?period=1h"\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Rate Limiting Issues:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Check rate limit status\ncurl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/rate-limits"\n\n# View rate limit history\ncurl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/rate-limit-events"\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Budget Issues:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Check budget status\ncurl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/budget"\n\n# View spending history\ncurl -H "Authorization: Bearer your-master-key" \\\n  "http://localhost:5002/api/admin/virtual-keys/550e8400-e29b-41d4-a716-446655440000/spending-history"\n'})}),"\n",(0,a.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,a.jsx)(n.h3,{id:"caching-strategy",children:"Caching Strategy"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Virtual key data cached for 5 minutes in Redis"}),"\n",(0,a.jsx)(n.li,{children:"Rate limit counters use sliding window in Redis"}),"\n",(0,a.jsx)(n.li,{children:"Usage statistics cached for 1 minute"}),"\n",(0,a.jsx)(n.li,{children:"Budget calculations cached for 30 seconds"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"database-optimization",children:"Database Optimization"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Indexes for virtual key queries\nCREATE INDEX CONCURRENTLY idx_virtual_keys_hash ON virtual_keys(key_hash);\nCREATE INDEX CONCURRENTLY idx_virtual_keys_enabled ON virtual_keys(is_enabled) WHERE is_enabled = true;\nCREATE INDEX CONCURRENTLY idx_virtual_keys_created ON virtual_keys(created_at DESC);\nCREATE INDEX CONCURRENTLY idx_virtual_key_usage_key_date ON virtual_key_usage(key_id, date DESC);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Provider Configuration"}),": Set up ",(0,a.jsx)(n.a,{href:"provider-configuration",children:"provider credentials and health monitoring"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Usage & Billing"}),": Explore ",(0,a.jsx)(n.a,{href:"usage-billing",children:"detailed analytics and billing"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"WebUI Guide"}),": Use the ",(0,a.jsx)(n.a,{href:"webui-guide",children:"administrative web interface"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Core APIs"}),": Learn about ",(0,a.jsx)(n.a,{href:"../core-apis/overview",children:"using virtual keys with Core APIs"})]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);